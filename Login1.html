<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Login page</title>
        <meta charset="UTF-8">
        <link rel="icon" href="1ct3.jpg" type="image/x-icon">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <style>
        body{
            text-align: center;
            padding: 50px;
            justify-items: center;
            font-family:Arial, Helvetica, sans-serif;
            background-image: url('backc4.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: top;
            min-height: 100vh;
        }
        section{
            background-color: #ccc;
            padding:60.5px;
            border-radius: 50px;
        }
        div{
            background-color: #ddd;
            padding: 24.6px;
            border-radius: 40px;
        }
        input{
            border-radius: 10px;
            border: none;
            padding:10px;
        }
        #login{
            background-color: blue;
            color:white;
            cursor:pointer;
        }
        #login:hover{
            background-color: rgb(135, 135, 173);
            color:red;
        }
           @media (max-width: 500px) {
            section {
                padding: 1.5rem;
            }
            div {
                padding: 1rem;
            }
            #login {
                font-size: 0.9rem;
                padding: 0.7rem;
            }
        }
    </style>
    <body>
        <section>
            <h2>Welcome Again</h2>
    <div>
        <form action="form222.html" id="login-form">
            <label for="name">Username</label><br>
            <input type="text" id="name" name="name" placeholder="name/email/phone-number" required><br><br>
            <label for="password">Password</label><br>
            <input type="password" id="password" name="password" minlength="8" maxlength="32" required><br><br>
            <input type="submit" id="login" value="Login">
        </form>
    </div>
    <p><a href="forget password.html">Forget Password?</a></p>
    <p>You don't have Account <a href="Sign up page.html">Sign up</a> </p>
        </section>
     
        <!-- Firebase SDKs for plain HTML/JS -->
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-analytics-compat.js"></script>

<script>
  // Your Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyBqSxgQCsUFgIz7eetzb2MMbO_DkHN2Zu8",
    authDomain: "my-portifolio-3f4c5.firebaseapp.com",
    projectId: "my-portifolio-3f4c5",
    storageBucket: "my-portifolio-3f4c5.firebasestorage.app",
    messagingSenderId: "1036053397124",
    appId: "1:1036053397124:web:3bdfea641c319d176a0cd1",
    measurementId: "G-MLBNWNV99Y"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();
  const analytics = firebase.analytics();
</script>


<script>
    const loginForm = document.getElementById('login-form');

loginForm.addEventListener('submit', async (e) => {
  e.preventDefault();

  const loginInput = document.getElementById('name').value;
  const password = document.getElementById('password').value;

  let emailToUse = "";

  try {
    // Get all users from Firestore
    const snapshot = await db.collection('users').get();

    snapshot.forEach(doc => {
      const data = doc.data();
      // Check if input matches username OR phone OR email
      if (data.username === loginInput || data.phone === loginInput || data.email === loginInput) {
        emailToUse = data.email;
      }
    });

    if (emailToUse === "") {
      alert("User not found!");
      return;
    }

    // Login with Firebase Auth
    await auth.signInWithEmailAndPassword(emailToUse, password);
    alert("Login successful!");
    window.location = "dashboard.html"; // redirect to dashboard

  } catch (err) {
    alert(err.message);
  }
});

</script>

</body>
</html>